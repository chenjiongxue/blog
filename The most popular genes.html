<!DOCTYPE html>
<html lang="zh">
<head>
          <title>seqyuan</title>
        <meta charset="utf-8" />
        <link href="jujuba.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="seqyuan Full Atom Feed" />
        <link href="jujuba.net/feeds/popular-genes.atom.xml" type="application/atom+xml" rel="alternate" title="seqyuan Categories Atom Feed" />


    <meta name="tags" content="matplotlib" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="jujuba.net/">seqyuan <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="jujuba.net/The most popular genes.html" rel="bookmark"
         title="Permalink to 复现The most popular genes in the human genome">复现The most popular genes in the human genome</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2017-11-30T00:00:00+08:00">
      四 30 十一月 2017
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="jujuba.net/author/seqyuan.html">seqyuan</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>从14年入行接触编程至今除早期入门阶段外很少记编程笔记，更多的是从以前写过的程序里去找自己想要的东西，两年前写的主要代码的架构和重要元素依稀记得。</p>
<p>前几天看到一篇文章《NATURE》长文：The most popular genes in the human genome，除了对文章的内容有很大兴趣之外，对于文中的图的精美也很向往，为了做matplotlib画图demo, 记录一些常用画图设置模板，我打算重现文中的两张图。</p>
<h3>要重现原图如下</h3>
<p>第一幅图是一个条形图,展示了被研究次数最多10个的基因
 第二幅图展示了所有基因的研究次数及基因在染色体上的位置</p>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/N1.jpg"></p>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/N2.jpg"></p>
<h3>下载的数据</h3>
<ul>
<li>
<p>顺藤摸瓜，找到做这个项目的github：https://github.com/pkerpedjiev/gene-citation-counts</p>
</li>
<li>
<p>发现人基因组所有基因被研究次数的文件https://github.com/pkerpedjiev/gene-citation-counts/all_gene_counts.tsv 果断下载</p>
</li>
<li>
<p>要重现第二幅图还需要基因组大小文件以及着丝粒在基因组上的位置信息，所以需要下载http://hgdownload.cse.ucsc.edu/goldenpath/hg19/database/chromInfo.txt.gz，http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/cytoBand.txt.gz</p>
</li>
<li>
<p>在作者github这个项目的Issues里发现有人提了一个问题：你做的都是针对gene，尝试做一下ncRNA会有更有意思的东西发现吧。作者果断甩出一个文件链接gene_info_total_human.tsv，回答说所有的基因组元件citations信息都在这里，你感兴趣自己玩去。我果断下载之，发现文件中被研究最多的基因按照研究次数进行了排序，所以这个文件就作为了我重现第一幅图的数据源。ps：唯一的Issues已经被作者删除，当然包括gene_info_total_human.tsv的下载地址</p>
</li>
</ul>
<h3>第一幅图被重现，程序用法如下</h3>
<p><code>python3 The_Most_Studied_Genes.py -i gene_info_total_human.tsv -n 20</code></p>
<h3>第一幅效果如下</h3>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/The_top10_citations.png">
 <img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/The_top20_citations.png"></p>
<h3>第二幅图照虎画猫</h3>
<p>输入参数就固定写了，程序和数据（all_gene_counts.tsv）放同一目录下，直接执行就会出结果，之所以没用gene_info_total_human.tsv作为数据源是因为gene_info_total_human.tsv不带有基因位置信息（省点事）</p>
<p><code>python3 gene_on_chrom.py</code> </p>
<h3>第二幅效果如下</h3>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/gene_on_chrom.png"></p>
<p>通过与原图的对比我发现和文章结果是一些出入的，在top10基因的排名上，有些不同，也许作者两组数据的产生时间稍有不同。如果想彻底问清楚可以一步步重现作者的搜集数据步骤，自己做数据搜集工作。</p>
<p>还有点不同是对于着丝粒区域的处理，我是按照比例显示，原图是给了固定的数值</p>
<h3>发现</h3>
<p>X染色体上被研究最多的一个基因为AR(Androgen receptor),蛋白结构如下：</p>
<p><img alt="AR PDB" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/AR_PDB.png"></p>
<p>在基因组上的位置</p>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/AR-gene.png"></p>
<h3>源代码</h3>
<p>https://github.com/seqyuan/programs/master/plot/The_Most_Studied_Genes</p>
<h3>微信公众号</h3>
<p>下图是我的微信公众号，会写一些生物信息相关的文章，欢迎关注。</p>
<p><img alt="avatar" src="https://raw.githubusercontent.com/seqyuan/programs/master/plot/The_Most_Studied_Genes/seqyuan.jpg"></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>