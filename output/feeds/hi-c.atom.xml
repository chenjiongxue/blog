<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>seqyuan - Hi-C</title><link href="jujuba.net/" rel="alternate"></link><link href="jujuba.net/feeds/hi-c.atom.xml" rel="self"></link><id>jujuba.net/</id><updated>2019-12-15T00:00:00+08:00</updated><entry><title>Hi-C文库相关性分析</title><link href="jujuba.net/libcor.html" rel="alternate"></link><published>2019-12-15T00:00:00+08:00</published><updated>2019-12-15T00:00:00+08:00</updated><author><name>seqyuan</name></author><id>tag:None,2019-12-15:jujuba.net/libcor.html</id><summary type="html"></summary><content type="html">&lt;p&gt;Hi-C分析需要的测序量比较高，1个样本往往需要测序很多的数据量，1个Hi-C文库可测序的数据量有限（一般情况下100-300G PE150，超出这个量，多测的数据可能含有较高的PCR dup），所以1个样本往往需要建几个文库来保证总的测序量足够。相同样本不同文库产生的数据需要有比较高的重复性，才能用于后续分析&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;为了计算方便，开发了一个R脚本hicLibRepeatCor.R用于Hi-C文库相关性分析，计算两两Hi-C文库的cis矩阵相关性，对所有文库的相关性矩阵做聚类热图,用于衡量判断样本文库的重复性，和不同样本文库的差异&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;程序地址&lt;/h3&gt;
&lt;p&gt;https://gitlab.com/seqyuan/ctools/blob/master/module/CQC/libCor/hicLibRepeatCor.R&lt;/p&gt;
&lt;h3&gt;程序用法&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Rscript hicLibRepeatCor.R &amp;lt;lib_matrix.list&amp;gt; &amp;lt;binsize&amp;gt; &amp;lt;outdir&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h3&gt;参数说明&lt;/h3&gt;
&lt;h4&gt;lib_matrix.list&lt;/h4&gt;
&lt;p&gt;此参数为每一个文库的matrix列表，示例如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;wt1&lt;/th&gt;
&lt;th&gt;1000000&lt;/th&gt;
&lt;th&gt;/abspath/wt1_1000000_symmetric.matrix&lt;/th&gt;
&lt;th&gt;/abspath/wt1_1000000_abs.bed&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;wt2&lt;/td&gt;
&lt;td&gt;1000000&lt;/td&gt;
&lt;td&gt;/abspath/wt2_1000000_symmetric.matrix&lt;/td&gt;
&lt;td&gt;/abspath/wt2_1000000_abs.bed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tr1&lt;/td&gt;
&lt;td&gt;1000000&lt;/td&gt;
&lt;td&gt;/abspath/tr1_1000000_symmetric.matrix&lt;/td&gt;
&lt;td&gt;/abspath/tr1_1000000_abs.bed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tr2&lt;/td&gt;
&lt;td&gt;1000000&lt;/td&gt;
&lt;td&gt;/abspath/tr2_1000000_symmetric.matrix&lt;/td&gt;
&lt;td&gt;/abspath/tr2_1000000_abs.bed&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;第一列：文库的命名&lt;/li&gt;
&lt;li&gt;第二列：对应行矩阵的bin size&lt;/li&gt;
&lt;li&gt;第三列：文库矩阵，格式同&lt;a href="http://nservant.github.io/HiC-Pro/RESULTS.html#intra-and-inter-chromosomal-contact-maps"&gt;HiC-Pro&lt;/a&gt;软件buildMatrix产生的3列矩阵的格式&lt;/li&gt;
&lt;li&gt;第四列：染色体位置与bin number对应关系bed文件，格式&lt;code&gt;HiC-Pro&lt;/code&gt;软件buildMatrix产生的bed文件&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;binsize&lt;/h4&gt;
&lt;p&gt;数字型，选择&lt;code&gt;lib_matrix.list&lt;/code&gt;参数中第二列与&lt;code&gt;binsize&lt;/code&gt;参数相同的matrix去做文库相关性分析&lt;/p&gt;
&lt;h4&gt;outdir&lt;/h4&gt;
&lt;p&gt;输出目录&lt;/p&gt;
&lt;h3&gt;输出结果示例&lt;/h3&gt;
&lt;p&gt;此程序会输出3个结果文件&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pair.pdf&lt;/li&gt;
&lt;li&gt;corr_heatmap.pdf&lt;/li&gt;
&lt;li&gt;cor_matr.matrix&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;pair.pdf&lt;/h4&gt;
&lt;p&gt;&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/pair.png"&gt;
&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/alllibpair.png"&gt;&lt;/p&gt;
&lt;h4&gt;corr_heatmap.pdf&lt;/h4&gt;
&lt;p&gt;&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/corr_heatmap.png"&gt;
&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/alllib_corr_heatmap.png"&gt;&lt;/p&gt;
&lt;h4&gt;cor_matr.matrix&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;corr_heatmap.pdf&lt;/code&gt;的数据文件，对于有编程经验的用户可以自己再去根据自己的喜好去画热图&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;wt1&lt;/th&gt;
&lt;th&gt;wt2&lt;/th&gt;
&lt;th&gt;tr1&lt;/th&gt;
&lt;th&gt;tr2&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;wt1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0.994581416401839&lt;/td&gt;
&lt;td&gt;0.946872471200991&lt;/td&gt;
&lt;td&gt;0.946223805271397&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;wt2&lt;/td&gt;
&lt;td&gt;0.994581416401839&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0.947224994844614&lt;/td&gt;
&lt;td&gt;0.946685529296875&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tr1&lt;/td&gt;
&lt;td&gt;0.946872471200991&lt;/td&gt;
&lt;td&gt;0.947224994844614&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;0.995740232735047&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tr2&lt;/td&gt;
&lt;td&gt;0.946223805271397&lt;/td&gt;
&lt;td&gt;0.946685529296875&lt;/td&gt;
&lt;td&gt;0.995740232735047&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;例如可以用以下python代码画图&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;mpl&lt;/span&gt;
&lt;span class="c1"&gt;# matplotlib.use(&amp;#39;TkAgg&amp;#39;) # for macbook&lt;/span&gt;
&lt;span class="c1"&gt;# matplotlib.use(&amp;#39;Agg&amp;#39;) # linux or win&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;seaborn&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sns&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cor_matr.matrix&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;index_col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clustermap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;sns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;color_palette&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;RdBu_r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7000&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;效果&lt;/p&gt;
&lt;p&gt;&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/sns_corr_heatmap.png"&gt;
&lt;img alt="avatar" src="https://gitlab.com/seqyuan/ctools/raw/master/module/CQC/libCor/fig/sns_6corr_heatmap.png"&gt;&lt;/p&gt;
&lt;h3&gt;程序依赖包&lt;/h3&gt;
&lt;p&gt;R环境需要安装以下两个R包才能使用此程序
&lt;em&gt;  &lt;a href="http://www.bioconductor.org/packages/release/bioc/html/HiTC.html"&gt;HiTC&lt;/a&gt;
&lt;/em&gt;  &lt;code&gt;pheatmap&lt;/code&gt;&lt;/p&gt;</content><category term="Hi-C"></category></entry></feed>